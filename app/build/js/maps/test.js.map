{"version":3,"sources":["test.coffee"],"names":[],"mappings":"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","file":"test.js","sourceRoot":"/source/","sourcesContent":["app = angular.module \"testApp\", []\n\n###\n# fix https://github.com/angular/angular.js/issues/9269\n###\napp.directive \"rangeParser\", () ->\n  return {\n    restrict: \"A\"\n    require: \"ngModel\"\n    link: (scope, element, attr, ctrl) ->\n      return unless ctrl?\n      ctrl.$parsers.push( (value) ->\n        val = Number(value)\n        val = null if val != val\n        return val\n      )\n  }\n\napp.constant \"defaultSum\", 100\n\n# TODO show float precision (use Math lib or something else)\n# TODO manage old values for save value if letter char input\napp.directive \"commaDetect\", () ->\n  return {\n    restrict: \"A\"\n    require: \"ngModel\"\n    link: (scope, element, attr, ctrl) ->\n      return unless ctrl?\n      oldV = null\n\n      check = (value) ->\n        return unless value?\n        return if parseInt(value) > 100\n        return if value.match(/^\\-/)\n        return if value.match(/[a-zA-Z]/)\n        if value.match(/\\.$/)\n          oldV = parseInt(value)\n        else\n          oldV = null\n\n        tVal = value.replace(/,/g,\".\")\n\n        if tVal != value\n          ctrl.$setViewValue tVal\n          ctrl.$render()\n\n        if oldV?\n          value = oldV\n        else\n          value = tVal\n\n        value\n\n      ctrl.$parsers.push check\n  }\n\napp.service \"Data\", ->\n  @dataNull =\n    items: [\n      name: \"item1\"\n      percent: 0\n    ,\n      name: \"item2\"\n      percent: 0\n    ,\n      name: \"item3\"\n      percent: 0\n    ]\n  @dataNorm =\n    items: [\n      name: \"item1\"\n      percent: 60\n    ,\n      name: \"item2\"\n      percent: 10\n    ,\n      name: \"item3\"\n      percent: 30\n    ]\n  @dataBig =\n    items: [\n      name: \"item1\"\n      percent: 70\n    ,\n      name: \"item2\"\n      percent: 30\n    ,\n      name: \"item3\"\n      percent: 80\n    ,\n      name: \"item4\"\n      percent: 100\n    ]\n  @dataSmall =\n    items: [\n      name: \"item1\"\n      percent: 10\n    ,\n      name: \"item2\"\n      percent: 20\n    ,\n      name: \"item3\"\n      percent: 30\n    ]\n  @dataOnce =\n    items: [\n      name: \"item1\"\n      percent: 140\n    ]\n  @dataTwice =\n    items: [\n      name: \"item1\"\n      percent: 140\n    ,\n      name: \"item2\"\n      percent: 90\n    ]\n  @\n\napp.directive \"balancer\", () ->\n  return {\n    restrict: \"A\"\n    templateUrl: \"template.html\",\n    transclude: true\n    scope: { items: \"=\" }\n    controller: ($scope, defaultSum)->\n      $scope.indexOfChanged = null\n\n      $scope.findSum = ->\n        sum = _.reduce(\n          $scope.items\n        ,\n          (memo, item)->\n            memo+item.percent\n        ,\n          0\n        )\n        sum\n\n      $scope.findDiff = ->\n        sum = do $scope.findSum\n        diff = parseFloat defaultSum - sum\n        diff\n\n      $scope.removeChanged = (scpItems, index) ->\n        if scpItems[index]\n          items = _.clone scpItems\n          items.splice index, 1\n          items\n\n      $scope.removeDisabled = (items) ->\n        result = _.reject(\n          items\n        ,\n          (item) ->\n            item.blocked == true\n        )\n        result\n\n      $scope.findAcceptor = (type) ->\n        items = $scope.removeChanged $scope.items, $scope.indexOfChanged\n        items = $scope.removeDisabled items\n\n        if type == \"min\"\n          acceptor = _.min(\n            items\n          ,\n            (item) ->\n              item.percent\n          )\n        else if type == \"max\"\n          acceptor = _.max(\n            items\n          ,\n            (item) ->\n              item.percent\n          )\n        acceptor\n\n      $scope.change = (index) ->\n        $scope.indexOfChanged = index\n\n      $scope.increasePercent = (item, acceptor, diffVal) ->\n        if item.name == acceptor.name\n          item.percent += diffVal\n\n          if item.percent > 100\n            item.percent = 100\n            do $scope.balance\n\n      $scope.decreasePercent = (item, acceptor, diffVal) ->\n        if item.name == acceptor.name\n          item.percent -= Math.abs diffVal\n\n          if item.percent < 0\n            item.percent = 0\n            do $scope.balance\n\n      $scope.balance = ->\n        items = _.clone $scope.items\n        length = items.length\n        diffVal = do $scope.findDiff\n\n        if length > 1\n          if diffVal > 0\n            acceptor = $scope.findAcceptor(\"min\")\n            ($scope.increasePercent item, acceptor, diffVal) for item in items\n\n          if diffVal < 0\n            acceptor = $scope.findAcceptor(\"max\")\n            ($scope.decreasePercent item, acceptor, diffVal) for item in items\n\n        $scope.items = _.clone items\n\n      $scope.findCurrentSum = (items) ->\n        sum = _.reduce(\n          items\n        ,\n          (memo, item)->\n            memo+item.percent\n        ,\n          0\n        )\n        sum\n\n      $scope.findMinVal = () ->\n        return 0\n\n      $scope.findMaxVal = () ->\n        items = _.clone $scope.items\n        items = $scope.removeDisabled items\n        unless items.length == $scope.items.length\n          maxVal = defaultSum - $scope.findCurrentSum items\n        else\n          maxVal = defaultSum\n        maxVal\n\n      $scope.checkCount = ->\n        scpILength = $scope.items.length\n        return true if scpILength == 1 or scpILength == 2\n\n      $scope.checkChange = (index) ->\n        items = _.clone $scope.items\n        items = $scope.removeDisabled items\n        $scope.items[index].blocked = false if ($scope.items.length - items.length) > 2\n\n#      $scope.dec = (index) ->\n#        $scope.change index\n#\n#      $scope.inc = (index) ->\n#        $scope.change index\n\n      $scope.$watch(\n        ->\n          $scope.items\n      ,\n        ->\n          do $scope.balance\n      ,\n        true\n      )\n  }\n# MainCtrl\napp.controller \"MainCtrl\", ($scope, $window, defaultSum, Data) ->\n  $scope.model = []\n  $window.model = $scope.model\n  $scope.defSum = defaultSum\n\n  sumCompute = (items) ->\n    sum = _.reduce(\n      items\n    ,\n      (memo, item)->\n         memo+item.percent\n    ,\n      0\n    )\n    sum\n\n  modItem = (item) ->\n    item[\"blocked\"] = false\n    item[\"getPercent\"] = ->\n      @percent\n    item[\"setPercent\"] = (points, type)->\n      if points == 1 or points == -1 or type == \"append\"\n        @percent += parseFloat(points)\n      else\n        @percent = parseFloat(points)\n      @percent\n    item\n\n  resolveProportion = (percent, sum) ->\n    return Math.round(percent*defaultSum/sum)\n\n  normalizeData = (data, sum) ->\n    _.each(\n      data\n    ,\n      (el) ->\n        el.percent = resolveProportion(el.percent, sum)\n    )\n\n  loadData = (dataType = Data.dataNull) ->\n    $scope.model = []\n    $scope.model.push(modItem i) for i in dataType.items\n\n  analiseData = ->\n    return if _.isEmpty $scope.model\n    length = $scope.model.length\n    sum = sumCompute($scope.model)\n    switch\n      when sum == 0 or length == 1    then $scope.model[0].percent = 100\n      when 0 < sum < 100 or sum > 100 then normalizeData($scope.model, sum)\n\n  $scope.init = (dataType)->\n    loadData dataType\n    do analiseData\n\n  $scope.setDataNull = ->\n    $scope.init Data.dataNull\n  $scope.setDataNorm = ->\n    $scope.init Data.dataNorm\n  $scope.setDataBig = ->\n    $scope.init Data.dataBig\n  $scope.setDataSmall = ->\n    $scope.init Data.dataSmall\n  $scope.setDataOnce = ->\n    $scope.init Data.dataOnce\n  $scope.setDataTwice = ->\n    $scope.init Data.dataTwice\n\n  return\n"]}